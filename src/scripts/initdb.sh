#!/bin/bash

set -e

psql -v ON_ERROR_STOP=1 -U "$POSTGRES_USER" <<-EOSQL
    CREATE DATABASE sinarm;

    \c sinarm;

    CREATE SCHEMA raw;
    CREATE SCHEMA refined;

    CREATE TABLE IF NOT EXISTS raw.ocorrencias (
        ID INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        ANO_OCORRENCIA INT,
        MES_OCORRENCIA INT,
        UF VARCHAR(2),
        MUNICIPIO VARCHAR(244),
        ESPECIE_ARMA VARCHAR(244),
        MARCA_ARMA VARCHAR(244),
        CALIBRE_ARMA VARCHAR(50),
        TIPO_OCORRENCIA VARCHAR(255),
        MAIS_1000_MIL_HAB VARCHAR(1),
        TOTAL BIGINT
    );

EOSQL
